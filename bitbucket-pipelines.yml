clone:
  depth: full
pipelines:

  default:
    - step:
        name: build
        image: openjdk:8
        caches:
          - gradle
          - gradlewrapper
        script:
          - chmod +x gradlew
          - ./gradlew test build -Dsonar.login=$SONAR_TOKEN
    - step:
        name: test
        image: openjdk:11
        caches:
          - sonarcloud
        script:
          - ./gradlew sonarqube